<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health and Fitness Tracker</title>
    <link rel="stylesheet" href="static/index.css">
    <script src="validation.js" defer></script>
    <!-- Include Chart.js from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <h1>Health and Fitness Tracker</h1>
    </header>

    <main>
        <section id="workout-form">
            <h2>Log Your Workout</h2>
            <form id="workoutForm">
                <div class="form-group">
                    <label for="exercise">Exercise:</label>
                    <input type="text" id="exercise" name="exercise" required>
                    <span class="error" id="exerciseError"></span>
                </div>

                <div class="form-group">
                    <label for="duration">Duration (minutes):</label>
                    <input type="number" id="duration" name="duration" required>
                    <span class="error" id="durationError"></span>
                </div>

               <div class="form-group">
    <label for="month">Month:</label>
    <select id="month" name="month" required>
        <option value="">Select Month</option>
        <option value="January">January</option>
        <option value="February">February</option>
        <option value="March">March</option>
        <option value="April">April</option>
        <option value="May">May</option>
        <option value="June">June</option>
        <option value="July">July</option>
        <option value="August">August</option>
        <option value="September">September</option>
        <option value="October">October</option>
        <option value="November">November</option>
        <option value="December">December</option>
    </select>
    <span class="error" id="monthError"></span>
</div>


<button type="submit" onclick="window.location.href='/chart'">Log Workout</button>

            </form>
        </section>

        <section id="progress">
            <h2>Track Your Progress</h2>
            <canvas id="progressChart" width="400" height="200"></canvas>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Health and Fitness Tracker</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const progressData = {{ progress_data|tojson }};
            const ctx = document.getElementById('progressChart').getContext('2d');

            const progressChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: progressData.labels,
                    datasets: [{
                        label: 'Workout Duration (minutes)',
                        data: progressData.data,
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });

            const workoutForm = document.getElementById('workoutForm');
            workoutForm.addEventListener('submit', function (event) {
                event.preventDefault();

                const exercise = document.getElementById('exercise').value;
                const duration = document.getElementById('duration').value;
                const month = document.getElementById('month').value;

                const workoutData = {
                    exercise: exercise,
                    duration: duration,
                    month: month
                };

                fetch('/update_progress', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(workoutData)
                })
                .then(response => response.json())
                .then(updatedData => {
                    progressData.labels.push(updatedData.month);
                    progressData.data.push(updatedData.duration);
                    progressChart.update();
                })
                .catch(error => console.error('Error:', error));
            });
        });
    </script>
</body>
</html> 
